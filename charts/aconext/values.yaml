# Global settings
nameOverride: ""
fullnameOverride: ""

# Image pull secrets
imagePullSecrets: []

# Core service configuration
core:
  enabled: true
  replicaCount: 1
  serviceAccount:
    create: true
    automount: true
    annotations: {}
    name: ""  # If not set, will use {{ release-name }}-core
  image:
    repository: ghcr.io/memodb-io/acontext-core
    tag: "latest"
    pullPolicy: Always
  
  service:
    type: ClusterIP
    port: 8000
  
  env:
    # LLM Configuration
    LLM_BASE_URL: ""  # Optional: Custom LLM base URL
    LLM_SDK: "openai"  # LLM SDK: "openai" or "anthropic"
    
    # S3 Configuration (AWS S3)
    S3_ENDPOINT: ""  # AWS S3 endpoint, e.g., https://s3.amazonaws.com or https://s3.us-east-1.amazonaws.com
  
  resources:
    limits:
      cpu: 1000m
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 1Gi
  
  livenessProbe:
    httpGet:
      path: /health
      port: 8000
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  
  readinessProbe:
    httpGet:
      path: /health
      port: 8000
    initialDelaySeconds: 10
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3
  
  # Pod annotations and labels
  podAnnotations: {}
  podLabels: {}
  
  # Security contexts
  podSecurityContext: {}
  securityContext: {}
  
  # Node selector, tolerations, affinity
  nodeSelector: {}
  tolerations: []
  affinity: {}

# API service configuration
api:
  enabled: true
  replicaCount: 1
  serviceAccount:
    create: true
    automount: true
    annotations: {}
    name: ""  # If not set, will use {{ release-name }}-api
  image:
    repository: ghcr.io/memodb-io/acontext-api
    tag: "latest"
    pullPolicy: Always
  
  service:
    type: ClusterIP
    port: 8029
  
  env:
    # API Configuration
    API_EXPORT_PORT: "8029"
    
    # S3 Configuration (AWS S3)
    S3_ENDPOINT: ""  # AWS S3 endpoint, e.g., https://s3.amazonaws.com
    S3_REGION: "us-east-2"  # AWS region
    S3_BUCKET: "acontext-assets"  # S3 bucket name
  
  resources:
    limits:
      cpu: 1000m
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 1Gi
  
  livenessProbe:
    httpGet:
      path: /health
      port: 8029
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  
  readinessProbe:
    httpGet:
      path: /health
      port: 8029
    initialDelaySeconds: 10
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3
  
  # Pod annotations and labels
  podAnnotations: {}
  podLabels: {}
  
  # Security contexts
  podSecurityContext: {}
  securityContext: {}
  
  # Node selector, tolerations, affinity
  nodeSelector: {}
  tolerations: []
  affinity: {}

# PostgreSQL configuration (Bitnami chart)
# Set enabled: false to use external PostgreSQL
postgresql:
  enabled: true
  image:
    repository: postgres
    tag: "16.1"
    pullPolicy: Always
  auth:
    username: "acontext"
    password: "acontext" 
    database: "acontext"
    postgresPassword: "postgres" 
  persistence:
    enabled: false

# Redis configuration (Bitnami chart)
# Set enabled: false to use external Redis
redis:
  enabled: true
  image:
    repository: bitnamilegacy/redis
    tag: "6.0.16"
    pullPolicy: Always
  auth:
    enabled: true
    password: "acontext" 

# RabbitMQ configuration (Bitnami chart)
# Set enabled: false to use external RabbitMQ
rabbitmq:
  enabled: true
  image:
    repository: bitnamilegacy/rabbitmq
    tag: "3.8.12"
    pullPolicy: Always
  auth:
    username: "acontext"
    password: "acontext" 
  persistence:
    enabled: false

# External service configuration (when not using internal services)
# When using external services, set the corresponding internal service (postgresql/redis/rabbitmq) enabled: false
# and configure the external service details below.
# Note: For production, use external-secrets operator or similar tools to inject passwords securely.
external:
  postgresql:
    host: ""  # External PostgreSQL host (e.g., rds-instance.region.rds.amazonaws.com)
    port: 5432
    username: "acontext"
    database: "acontext"
  
  redis:
    host: ""  # External Redis host (e.g., redis-cluster.cache.amazonaws.com)
    port: 6379
  
  rabbitmq:
    host: ""  # External RabbitMQ host
    port: 5672
    username: "acontext"
    vhost: "/"  # RabbitMQ virtual host

# Secrets configuration
# For production, use external-secrets operator or similar tools to inject these values securely
# TODO: use external-secrets operator
secrets:
  # PostgreSQL secrets (used when using external PostgreSQL)
  # These are also used to override internal PostgreSQL passwords if needed
  postgresql:
    password: ""
    postgresPassword: ""
  
  # Redis secrets (used when using external Redis)
  # Also used to override internal Redis password if needed
  redis:
    password: ""
  
  # RabbitMQ secrets (used when using external RabbitMQ)
  # Also used to override internal RabbitMQ credentials if needed
  rabbitmq:
    password: ""
    erlangCookie: ""
  
  # Application secrets
  llm:
    apiKey: ""  # LLM API key (OpenAI or Anthropic)
  
  api:
    rootBearerToken: ""  # Root API bearer token for admin operations
  
  s3:
    accessKey: ""  # AWS S3 access key
    secretKey: ""  # AWS S3 secret key

# TODO: HTTPRoute configuration (Gateway API)
